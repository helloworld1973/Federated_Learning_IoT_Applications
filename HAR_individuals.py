import os

from matplotlib import pyplot as plt

import HAR_CNN as cnn

index_list = ['sub_' + str(i + 1) for i in range(24)]

accuracy_list = []
for i in index_list:
    a_cnn = cnn.CNN_individual(i)
    X_train, X_test, y_train, y_test = a_cnn.load_data()
    acc_list = a_cnn.run(100, X_train, X_test, y_train, y_test)
    accuracy_list.append(acc_list)

    for x in range(len(acc_list)):
        print(acc_list[x])

print()


'''
# ====================================================================================================================
# all
path = "./all/"

index_list = [i for i in range(100, 103)] + [i for i in range(104, 110)] + [i for i in range(111, 120)] + \
             [i for i in range(121, 125)] + [i for i in range(200, 204)] + [i for i in range(205, 206)] + \
             [i for i in range(207, 211)] + [i for i in range(212, 216)] + [i for i in range(217, 218)] + \
             [i for i in range(220, 224)] + [i for i in range(228, 229)] + [i for i in range(230, 235)]
# ====================================================================================================================
'''

'''
# ====================================================================================================================
path = "./50_60_all/"
index_list = [119, 122, 214, 112, 234, 233, 205]
# ====================================================================================================================
'''

'''
# ====================================================================================================================
path = "./50_60_F/"
index_list = [119, 234]
# ====================================================================================================================
'''

'''
# ====================================================================================================================
# all
path = "./50_60_M/"
index_list = [122, 214, 112, 233, 205]
# ====================================================================================================================
'''

'''
# ====================================================================================================================
path = "./60_70_all/"
index_list = [213, 209, 107, 123, 109, 200, 217, 104, 116, 201, 202, 100, 117, 118]
# ====================================================================================================================
'''

'''
# ====================================================================================================================
path = "./60_70_F/"
index_list = [123, 104]
# ====================================================================================================================
'''

'''
# ====================================================================================================================
path = "./60_70_M/"
index_list = [213, 209, 107, 109, 200, 217, 116, 201, 202, 100, 117, 118]
# ====================================================================================================================
'''

'''
# ====================================================================================================================
path = "./70_80_all/"
index_list = [114, 231, 105, 223, 101, 232, 124, 228]
# ====================================================================================================================
'''

'''
# ====================================================================================================================
path = "./70_80_F/"
index_list = [114, 231, 105, 101, 232, 228]
# ====================================================================================================================
'''

'''
# ====================================================================================================================
path = "./70_80_M/"
index_list = [223, 124]
# ====================================================================================================================
'''

'''
# ====================================================================================================================
path = "./80_90_all/"
index_list = [215, 121, 221, 102, 222, 108, 220, 207, 210]
# ====================================================================================================================
'''

'''
# ====================================================================================================================
path = "./80_90_F/"
index_list = [121, 102, 222, 108, 220, 207]
# ====================================================================================================================
'''

'''
# ====================================================================================================================
path = "./80_90_M/"
index_list = [215, 221, 210]
# ====================================================================================================================
'''

'''
# ====================================================================================================================
path = "./all_M/"
index_list = [122,214,112,233,205,213,209,107,109,200,217,116,201,202,100,117,118,223,124,215,221,210]
# ====================================================================================================================
'''

'''
# ====================================================================================================================
path = "./all_F/"
index_list = [119, 234, 123, 104, 114, 231, 105, 101, 232, 228, 121, 102, 222, 108, 220, 207]
# ====================================================================================================================
'''

'''
# ====================================================================================================================
path = "./all/"
index_list = [122, 214, 112, 233, 205, 213, 209, 107, 109, 200, 217, 116, 201, 202, 100, 117, 118, 223, 124, 215, 221,
              210, 119, 234, 123, 104, 114, 231, 105, 101, 232, 228, 121, 102, 222, 108, 220, 207]
# ====================================================================================================================
'''

'''
# federated learning
users_list=[]
sub_path = "./r_c"
with open(path + sub_path, 'r_s') as file:
    lines = file.readlines()
    for a_index in index_list:
        pattern = str(a_index) + '_loss:'
        a_user_100 = []
        for line in lines:
            if pattern in line:
                abc = line.split('_accuracy:')
                accuracy = float(abc[1].replace('\n',''))
                a_user_100.append(accuracy)
        users_list.append(a_user_100)
print()
'''

'''
# individual CNN
users_list_no_FL = []
for a_index in index_list:
    a_cnn = cnn.CNN_individual(a_index)
    acc_list = a_cnn.run()
    users_list_no_FL.append(acc_list)
print()
'''

'''
# plot figure
for i in range(len(users_list)):
    a_user_fl = users_list[i]
    a_user_cnn = users_list_no_FL[i]
    plt.plot([i for i in range(0,100)], a_user_fl, label='a_user_after_federated_learning', color='c')
    plt.plot([i for i in range(0,100)], a_user_cnn, label='a_user_only_trained_cnn', color='m')
    plt.legend()
    plt.savefig(str(index_list[i])+'.png')
    plt.close()
    print()
'''